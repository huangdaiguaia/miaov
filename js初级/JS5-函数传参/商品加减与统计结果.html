<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>终版</title>
<script>
window.onload = function () {
	var oUl = document.getElementById('list');
	var aLi = oUl.getElementsByTagName('li');

	for ( var i=0; i<aLi.length; i++ ) {
		fnCount ( aLi[i]);
	}

	function fnCount ( li) {
		var aBtn = li.getElementsByTagName ('input');
		var oStrong = li.getElementsByTagName ('strong')[0];
		var oEm = li.getElementsByTagName ('em')[0];
		var oSpan = li.getElementsByTagName ('span')[0];
		var n = oStrong.innerHTML;			// '0'
		var price = parseFloat(oEm.innerHTML);			// 12.5

		aBtn[0].onclick = function () {
			if ( n > 0 ) {
				n--;
			}
			oStrong.innerHTML = n;
			oSpan.innerHTML = n*price + '元';
			sum();
		};

		aBtn[1].onclick = function () {
			n++;
			oStrong.innerHTML = n;
			oSpan.innerHTML = n*price + '元';
			sum();
		};

		function sum(){
			var oP=document.getElementsByTagName('p')[0];
			var apSpan=oP.getElementsByTagName('span');

			var aStrong=oUl.getElementsByTagName('strong');
			var aSpan=oUl.getElementsByTagName('span');
			var aEm=oUl.getElementsByTagName('em');

			var sum=0;            //每点击一次sum应该清零一次 所以我们找来一个函数使其成为局部作用域
			var money=0;
			var priceMax=[];

			for(var i=0;i<aStrong.length;i++){
				sum += Number(aStrong[i].innerHTML);
				money+=parseFloat(aSpan[i].innerHTML);

				if(Number(aStrong[i].innerHTML)){
					priceMax.push(parseFloat(aEm[i].innerHTML));
				}

			}
			apSpan[0].innerHTML=sum;
			apSpan[1].innerHTML=money;

			priceMax.sort(function(a,b){return b-a;}); //从大到小排序
			apSpan[2].innerHTML=priceMax[0];

		}

	}


};
</script>
</head>

<body>

<ul id="list">
	<li>
  	<input type="button" value="-" />
    <strong>0</strong>
  	<input type="button" value="+" />
    单价：<em>12.5元</em>
    小计：<span>0元</span>
  </li>
	<li>
  	<input type="button" value="-" />
    <strong>0</strong>
  	<input type="button" value="+" />
    单价：<em>10.5元</em>
    小计：<span>0元</span>
  </li>
	<li>
  	<input type="button" value="-" />
    <strong>0</strong>
  	<input type="button" value="+" />
    单价：<em>8.5元</em>
    小计：<span>0元</span>
  </li>
	<li>
  	<input type="button" value="-" />
    <strong>0</strong>
  	<input type="button" value="+" />
    单价：<em>8元</em>
    小计：<span>0元</span>
  </li>
	<li>
  	<input type="button" value="-" />
    <strong>0</strong>
  	<input type="button" value="+" />
    单价：<em>14.5元</em>
    小计：<span>0元</span>
  </li>
</ul>
<p>
商品合计共：<span>0</span>件<br>
共花费了：<span>0</span>元<br>
其中最贵的商品单价是：<span>0</span>元  <!-- 在买的东西中单价最高的 -->
</p>
</body>
</html>
